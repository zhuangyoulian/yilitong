<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>设计师身份认证——材料上传-{$config['shop_info_store_title']}</title>
	<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE">
    <meta http-equiv="keywords" content="{$config['shop_info_store_keyword']}" />
    <meta name="description" content="{$config['shop_info_store_desc']}" />
    <link rel="stylesheet" href="__STATIC__/css/index.css" type="text/css">

    <link rel="stylesheet" href="__STATIC__/css/user-new-style.css">
    <link rel="stylesheet" href="__STATIC__/css/designer.css">

    <link rel="stylesheet" href="__BUSINESS__/style/diyUpload.css" />
    <link rel="stylesheet" href="__BUSINESS__/style/webuploader.css" />


    <script>
        if(navigator.appName == "Microsoft Internet Explorer"&&parseInt(navigator.appVersion.split(";")[1].replace(/[ ]/g, "").replace("MSIE",""))<10){
            alert("您的IE浏览器版本过低，为增加更好的使用体验，请下载IE10及以上版本或者使用谷歌，火狐，搜狗，360等其它浏览器");
        }
    </script>
    <style>
        #organization_code_electronic,#general_taxpayer,#bank_licence_electronic,#proxy{
            border-radius:4px;
            width:100%;
            height:100%;
            line-height:100px;
        }
        .webuploader-pick{
            width:100%;
            height:100%;
            text-align:center;
            padding:0;
            background:#efefef;
            color:#888;
            line-height:100px;
        }
        .parentFileBox{
            /*position:absolute;*/
            position:absolute;
            width:200px !important;
            height:100px !important;
            background:#fff;
            left:0;
            top:0;
            z-index: 20;
            overflow: visible;
        }
        .parentFileBox>.fileBoxUl {
            position: relative;
            width: 100% !important;
            height: 100% !important;
            overflow: auto;
        }
        .parentFileBox>.fileBoxUl>li {
            /*float: left;*/
            border-radius: 5px;
            width: 200px;
            height: 100px;
            margin-top: 0;
            margin-left: 0;
            position: relative;
            background-color:#fff;
            border:none;
            overflow:auto;
        }
        .parentFileBox>.fileBoxUl>li>.viewThumb {
            position: absolute;
            top: 0;
            left: 0;
            width:200px !important;
            height:100px !important;
            overflow: hidden;
        }
        .parentFileBox>.fileBoxUl>li>.viewThumb img{
            width:100% !important;
            height:100% !important;
        }
        .diyUploadHover{
            width:200px !important;
            height:100px !important;
        }
        .diyButton{
            float:right;
            position:absolute;
            width:200px;
            left:0;
            bottom:-70px;
            z-index: 9999;
        }
        .diyButton a{
            display:block;
            float:left;
            width:60px;
            height:20px;
            border-radius:2px;
            text-align:center;
            line-height:20px;
            margin-right:30px;
        }
        .diyButton a:last-of-type{
            margin-right:0;
        }
        .parentFileBox>.fileBoxUl>li>.diyBar {
            top: 0;
            left: 0;
            position: absolute;
            width: 200px;
            height: 100px;
            line-height: 100px;
            /*background: url(../images/bgblack.png);*/
            background:rgba(0,0,0,.5);
            display: none;
        }
        .diyProgressText{
            width:200px;
            text-align:center;
            line-height:100px;
        }
    </style>
</head>

<body style="background:#f7f7f7;">
<!--最顶部-->
<include file="public/siteTopbar" />

<!--------在线客服-------------->
<include file="public/service" />
<!--------在线客服-------------->

<div class="user-home">
    <div class="inner clearfix">
        <div class="logo-home">
            <a href="/">
                <img src="__STATIC__/images/userIndexLogo.png" alt="logo">
                <p>（返回一礼通商城首页）</p>
            </a>
        </div>
        <a href="{:Url('Home/User/index')}" class="exit">退出设计师后台</a>
    </div>
</div>


<div class="inner clearfix m-top-20">
    <!-- design-left  start -->
    <div class="design-menu" style="background:#fff;">
        <div class="designer-head-img"><img src="{$user.head_pic|default='__STATIC__/images/tou2.png'}" alt="头像"></div>
        <p class="designer-account">用户：<span>{$user['nickname']}</span></p>
        <p class="authentication-tips">（尚未提交身份认证）</p>
        <ul class="designer-works grayColor">
            <li><a href="javascript:void(0);">我的作品</a></li>
            <li><a href="javascript:void(0);">在售作品</a></li>
            <li><a href="javascript:void(0);">我的订单</a></li>
            <li><a href="javascript:void(0);">退货单</a></li>
            <li><a href="javascript:void(0);">收入</a></li>
            <li><a href="javascript:void(0);">设计报价</a></li>
        </ul>
    </div>
    <!-- designer-left end -->

    <!-- design-right  start -->
    <div class="design-authentication" style="background:#fff;">
        <div class="authentication-title"><p>2、设计师身份认证——材料上传（带 * 的为必填内容）</p></div>

        <form class="form-horizontal" >
            <!-- <div class="authentication-uploadImg" id="authentication-uploadImg"> -->
            <input type="hidden" name="user_id" id="user_id-1" value="{$data.user_id}">
            <div class="authentication-uploadImg">
                <p class="uploadImg-type-title">* 本人身份证上传（必填）</p>
                <ul class="uploadImg-list clearfix">
                    <li>
                        <div id="organization_code_electronic"></div>
                        <p class="designer-uploadImg-tips">* 本人身份证正面上传</p>
                    </li>
                    <li>
                        <div id="general_taxpayer"></div>
                        <p class="designer-uploadImg-tips">* 本人身份证反面上传</p>
                    </li>
                </ul>
                <p class="uploadImg-type-title">* 其它证明材料上传（必填）如：设计证书，个人作品图片，工作室图片等</p>
                <ul class="uploadImg-list clearfix">
                    <li>
                        <div id="bank_licence_electronic"></div>
                        <p class="designer-uploadImg-tips">* 其它证明材料上传</p>
                    </li>
                    <li>
                        <div id="proxy"></div>
                        <p class="designer-uploadImg-tips">* 其它证明材料上传</p>
                    </li>
                </ul>
                <p class="uploadImg-type-title">学历证明（选填）</p>
                <ul class="uploadImg-list clearfix">
                    <li>
                        <div id="reading_protocol"></div>
                        <p class="designer-uploadImg-tips">学历证明（可选）</p>
                    </li>
                </ul>
            </div>
            <!--
                [存储路径]：本人身份证正面上传  ->  本人身份证反面上传  ->  其它证明材料上传（可选）
            -->
            <input type="hidden" name="organization_code_electronic" id="organization_code_electronic-1" value="{$data.organization_code_electronic}">
            <input type="hidden" name="general_taxpayer" id="general_taxpayer-1" value="{$data.general_taxpayer}">
            <input type="hidden" name="bank_licence_electronic" id="bank_licence_electronic-1" value="{$data.bank_licence_electronic}">
            <input type="hidden" name="proxy" id="proxy-1" value="{$data.proxy}">
            <input type="hidden" name="reading_protocol" id="reading_protocol-1" value="{$data.reading_protocol}">
        </form>
        <div class="designer-submit-btn-group">
            <a href="{:Url('Home/Designer/designerAuth_1')}" class="design-submit-2" >上一步</a>
            <a href="javascript:void(0);" class="design-submit-2" id="design-submit-2-next" onclick="verifyForm()">下一步</a>
        </div>

    </div>
    <!-- designer-right end -->
</div>

<!--------footer-开始-------------->
<include file="public/footer" />
<!--------footer-结束-------------->
<script src="__PUBLIC__/js/jquery-3.1.1.min.js"></script>
<script src="__PUBLIC__/static/js/layer/layer.js"></script>
<script src="__PUBLIC__/js/global.js"></script>
<script src="__BUSINESS__/js/webuploader.html5only.min.js"></script>
<script src="__BUSINESS__/js/diyUpload.js"></script>

<script>
    
        function verifyForm() {
			if($('#organization_code_electronic-1').val() == ''){
                layer.alert("请上传身份证正面");
                return false;
            }
            if($('#general_taxpayer-1').val() == ''){
                layer.alert("请上传身份证反面");
                return false;
            }
            if($('#bank_licence_electronic-1').val() == ''){
                layer.alert("请上传相关证明材料");
                return false;
            }
            if($('#proxy-1').val() == ''){
                layer.alert("请上传相关证明材料2");
                return false;
            }

            $.ajax({
                type:'POST',
				url:'add_designerAuth_2',
                dataType:'json',
                data:{
                        user_id:$('#user_id-1').val(),
						organization_code_electronic:$('#organization_code_electronic-1').val(),
                        general_taxpayer:$('#general_taxpayer-1').val(),
                        bank_licence_electronic:$('#bank_licence_electronic-1').val(),
                        proxy:$('#proxy-1').val(),
                        reading_protocol:$('#reading_protocol-1').val()
					},
                error: function () {
                    layer.alert("服务器繁忙");
                },
                success: function (data) {
                    if (data.status== 1) {
                        layer.msg(data.msg, {
                            icon: 1,
                            time: 1000
                        }, function(){
                            //成功提交后页面跳转的路径
                            location.href = "{:Url('Home/Designer/designerAuth_3')}";
                            //window.location = "designerAuth_2";
                        });
                    } else {
                        layer.msg(data.msg, {icon: 2,time: 1000});
                        $.each(data.result, function (index, item) {
                            $(index).text(item).show();
                        });
                    }
                }
            });

        }

        //图片上传
        var userList = [ "organization_code_electronic","general_taxpayer","bank_licence_electronic","proxy","reading_protocol"];  //图片按钮
        var userVal = ["organization_code_electronic-1","general_taxpayer-1","bank_licence_electronic-1","proxy-1","reading_protocol-1"];  //上传图片的值
        $.each(userList,function(i,item){
            var obj=$('#'+item);
            var val=$("#"+userVal[i]);
            //图片上传
            obj.diyUpload({
               	url:'upload',
                success:function( data ) {
                    var data = data._raw;
                    if(data == 2){
                        alert('文件过大');
                    }else if(data == 1){
                        alert('上传失败');
                    }
                    val.val(data);
                },
                error:function( err ) {
                
                    console.info( err );
                },
                buttonText : '',
                chunked:true,
                // 分片大小
                chunkSize:512 * 1024,
                //最大上传的文件数量, 总文件大小,单个文件大小(单位字节);
                fileNumLimit:1,
                //fileSizeLimit:500000 * 1024,
                //fileSingleSizeLimit:50000 * 1024,
                fileSingleSizeLimit:1024 * 1024 * 2,
                accept: {}
            });
        });
    

</script>
</body>
</html>