<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
		<title>礼品采购清单</title>
		<link rel="stylesheet" href="__XCSS__/iconfont.css">
		<link rel="stylesheet" href="__XCSS__/normalize.css">
		<link rel="stylesheet" href="__XCSS__/public.css">
		<link rel="stylesheet" href="__XCSS__/need_2.css">
	</head>

	<body>
		<div id="app" class="flexc h bggrey">
			<!-- 标题 -->
			<header class="bgf">
				<div class="flexr p10 head bbe">
					<span class="iconfont icon-fanhui em1.4" @click="goback"></span>
					<div class="flex1 title c">礼品采购清单</div>
				</div>
			</header>
			<!-- 导航 -->
			<nav class="bgf f13">
				<div class="flexr grey nav p10">
					<div class="flexr">
						<div class="c pb5"><span class="circle bgmain">1</span></div>
						<div class="pl5 pt1 cmain">基本信息</div>
					</div>
					<div class="flex1 c"><span class="navnext iconfont icon-xiayibu"></span></div>
					<div class="flexr">
						<div class="c pb5"><span class="circle bgmain">2</span></div>
						<div class="pl5 pt1 cmain">需求信息</div>
					</div>
					<div class="flex1 c"><span class="navnext iconfont icon-xiayibu"></span></div>
					<div class="flexr">
						<div class="c pb5"><span class="circle bggrey2">3</span></div>
						<div class="pl5 pt1">联系方式</div>
					</div>
					<!-- <div class="flex1  flexr">
                    <div class="">
                        <div class="c pb5"><span class="circle bgmain">1</span></div>
                        <div class="cmain">基本信息</div>
                    </div>
                    <div class="flex1 c pt18"><span class="navnext iconfont icon-xiayibu"></span></div>
                </div>
                <div class="flex1  flexr">
                    <div class="">
                        <div class="c pb5"><span class="circle bgmain">2</span></div>
                        <div class="cmain">需求信息</div>
                    </div>
                    <div class="flex1 c pt18"><span class="navnext iconfont icon-xiayibu"></span></div>
                </div>
                <div class="flex1 flexr">
                    <div class="">
                        <div class="c pb5"><span class="circle bggrey2">3</span></div>
                        <div class="">供应商要求</div>
                    </div>
                    <div class="flex1 c pt18"><span class="navnext iconfont icon-xiayibu"></span></div>
                </div>
                <div class="flexr">
                    <div class="">
                        <div class="c pb5"><span class="circle bggrey2">4</span></div>
                        <div class="">联系方式</div>
                    </div>
                </div> -->
				</div>
			</nav>
			<!-- <div class="set" >
                <span class="iconfont icon-shezhi-copy imp"></span> <span>管理</span>
                <span style="font-size: 14px;" class="iconfont icon-shezhi-copy"></span> <span>完成</span>
                </div> -->
			<!-- 主要内容区 -->
			<section class="main flex1 pt10 oa">
				<div class="box flexr">
					<!-- <span class="check"><input type="radio"></span> -->
					<div class="left">*</div>
					<div class="">产品名称</div>
					<div class="flex1 r">
						<input class="placeholder" placeholder="请输入礼品名称" value="{designation}" v-model="designation">
					</div>
				</div>
				<div class="box flexr">
					<div class="left"></div>
					<div class="">规格</div>
					<div class="flex1 r">
						<input class="placeholder" placeholder="请输入礼品规格" value="{specification}" v-model="specification">
					</div>
				</div>
				<div class="box flexr">
					<div class="left"></div>
					<div class="">颜色</div>
					<div class="flex1 r">
						<input class="placeholder" placeholder="请输入礼品颜色" value="{tinct}" v-model="tinct"></div>
				</div>
				<div class="box flexr">
					<div class="left"></div>
					<div class="">品牌</div>
					<div class="flex1 r">
						<input class="placeholder" placeholder="请输入礼品品牌" value="{brand}" v-model="brand"></div>
				</div>
				<div class="box flexr">
					<div class="left">*</div>
					<div class="">单位</div>
					<div class="flex1 r">
						<input class="placeholder" placeholder="请输入礼品单位" value="{unit}" v-model="unit">
					</div>
				</div>
				<div class="box flexr">
					<div class="left">*</div>
					<div class="">数量</div>
					<div class="flex1 r">
						<input type="tel" class="placeholder" placeholder="请输入礼品数量" value="{quantity}" v-model.number="quantity">
					</div>
				</div>
				<!-- <div class="box flexr">
                <div style="color: red;padding-right:5px;" class="iconfont icon-shangchuantupian"></div>
                <div class="">上传图片</div>
            </div> -->
				<!-- <div style="text-align: right;margin-right: 10px;font-size: 14px;padding-top: 20px;">
                        <span style="padding-right: 2px;font-size: 14px;font-size: 14px;" class="iconfont icon-tianjia-copy"></span> <span>添加</span>
                        <span style="padding-right: 2px;font-size: 14px;" class="iconfont icon-tianjia-copy"></span> <span>删除</span>
                    </div> -->
				<div class="annotation">如需批量提交礼品采购清单，可通过一礼通PC端操作。</div>
			</section>
			<!-- 底部 -->
			<footer>
				<div id="foot" v-show="showNext">
					<p class="next bgmain cf" @click="next">下一步</p>
				</div>
			</footer>
		</div>
		<script src="__XJS__/vue.js"></script>
		<script src="__XJS__/vue-resource.js"></script>
		<script src="__PUBLIC__/js/jquery-3.1.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script>
			// 监听window的变化
			window.addEventListener('resize', function() {
				var clientHeight = document.documentElement.clientHeight;
				app.clientHeight = clientHeight;
				console.log('可见区域高度:' + clientHeight);
				if (clientHeight < 400) {
					app.showNext = false;

				} else {
					app.showNext = true;
				}

			});

			var app = new Vue({
				el: "#app",
				data: {
					designation: "<?php echo $procurementlist['goods_name'];?>", //产品名称
					specification: "<?php echo $procurementlist['goods_norm'];?>", //规格
					tinct: "<?php echo $procurementlist['goods_color'];?>", //颜色
					brand: "<?php echo $procurementlist['goods_brand'];?>", //品牌
					unit: "<?php echo $procurementlist['goods_unit'];?>", //单位
					quantity: "<?php echo $procurementlist['goods_num'];?>", //数量
					allSubmitData: {}, // 存储所有要提交的数据
					showNext: true, // 显示下一步
					clientHeight: 0

				},
				directives: {

				},
				created: function() { // 进入

				},
				mounted: function() { // 挂载后


				},
				updated: function() {

				},
				methods: {
					goback: function(e) { // 返回上一页
						history.back(-1);
					},
					next: function(e) { // 下一步
						console.log("点击下一步:");
						var objData = {
							designation: this.designation,
							specification: this.specification,
							tinct: this.tinct,
							brand: this.brand,
							unit: this.unit,
							quantity: this.quantity,

						}
						console.log(objData);
						// 必填项验证
						if (!this.designation || !this.unit || !this.quantity) {
							this.allSubmitData = null;
							alert("请先填完所有带*的必填项");
							return false;
						}
						var regNumber = new RegExp("^[0-9]*$");
						console.log("数量：" + this.quantity)
						if (!regNumber.test(this.quantity)) {
							alert("数量只能是数字");
							this.quantity = "";
							return false;
						}


						this.allSubmitData = objData; //  所有要提交的数据
						this.submitData();
						console.log("进入下一页...");
					//	location.href = "./contact_2.html"
					},
					submitData: function() { //  提交数据给后端

						$.ajax({
							type:'POST',
							url:"{:Url('Supplychain/procurement_two')}",
							//dataType:'json',
							data:this.allSubmitData,
							success:function(data){
								if(date=0){
									console.log('数据库入库失败！');
								}else{
									console.log(data+'提交成功！');
									window.location.href="{:Url('Supplychain/procurement_three')}";
								}
							},
							error:function(jqXHR){
								console.log('提交失败！');
								alert('系统繁忙！请重试');
							}
						});

					}

				},

			})
			console.log("app.designation:");
			console.log(app.designation);
		</script>
	</body>

</html>
